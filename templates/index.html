<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BuildAI Pro</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Inter', sans-serif;
}

body {
    background: #f4f5f7;
    color: #333;
}

/* Navbar */
.navbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 18px 40px;
    background: linear-gradient(90deg,#6a6fd1,#7b4fb5);
    color: white;
}

.navbar h2 {
    font-weight: 700;
    margin: 0;
}

/* Right side menu */
.navbar ul {
    list-style: none;
    display: flex;
    gap: 35px;
    margin: 0;
    padding: 0;
}

.navbar li a {
    color: white;
    text-decoration: none;
    font-weight: 500;
    font-size: 18px;
}

.navbar li a:hover {
    opacity: 0.8;
}


/* Hero */
.hero {
    background: linear-gradient(135deg,#6a6fd1,#7b4fb5);
    color: white;
    text-align: center;
    padding: 100px 20px;
}

.hero h1 {
    font-size: 48px;
    margin-bottom: 20px;
}

.hero p {
    max-width: 700px;
    margin: auto;
    font-size: 18px;
    line-height: 1.6;
}

.hero button {
    margin-top: 30px;
    padding: 14px 40px;
    border-radius: 30px;
    border: none;
    background: white;
    color: #6a6fd1;
    font-weight: 600;
    cursor: pointer;
}

/* Section titles */
.section {
    padding: 60px 40px;
    text-align: center;
}

.section h2 {
    font-size: 36px;
    margin-bottom: 10px;
}

.section p {
    color: #666;
    margin-bottom: 40px;
}

/* Cards */
.cards {
    display: flex;
    gap: 30px;
    justify-content: center;
    flex-wrap: wrap;
}

.card {
    background: white;
    padding: 30px;
    border-radius: 14px;
    width: 280px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.08);
}

.card h3 {
    margin: 15px 0;
}

/* Steps */
.steps {
    display: flex;
    justify-content: center;
    gap: 50px;
    flex-wrap: wrap;
}

.step {
    text-align: center;
    max-width: 220px;
}

.circle {
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg,#6a6fd1,#7b4fb5);
    border-radius: 50%;
    color: white;
    font-size: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: auto;
    margin-bottom: 15px;
}

/* Technology section */
.tech {
    background: linear-gradient(135deg,#6a6fd1,#7b4fb5);
    color: white;
    padding: 60px 40px;
}

.tech-cards {
    display: flex;
    justify-content: center;
    gap: 25px;
    flex-wrap: wrap;
}

.tech-card {
    border: 1px solid rgba(255,255,255,0.3);
    padding: 25px;
    border-radius: 12px;
    width: 220px;
}

/* Calculator */
.calculator {
    padding: 60px 40px;
}

.calc-container {
    display: flex;
    gap: 30px;
    flex-wrap: wrap;
}

.calc-box {
    background: white;
    padding: 25px;
    border-radius: 12px;
    flex: 1;
    min-width: 300px;
}

input, select {
    width: 100%;
    padding: 10px;
    margin: 10px 0;
    border-radius: 8px;
    border: 1px solid #ccc;
}

button.calc-btn {
    width: 100%;
    padding: 12px;
    background: linear-gradient(90deg,#6a6fd1,#7b4fb5);
    color: white;
    border: none;
    border-radius: 8px;
    margin-top: 10px;
    cursor: pointer;
}

.result-box {
    background: #f7f8fc;
    padding: 15px;
    border-radius: 10px;
    margin-top: 10px;
}

@media(max-width:900px) {
    .cards, .steps, .calc-container, .tech-cards {
        flex-direction: column;
        align-items: center;
    }
}
/* Chatbot container */
#chatbot {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 9999;
}

/* Toggle button */
#chat-toggle {
    background: linear-gradient(135deg,#6a6fd1,#7b4fb5);
    color: white;
    border: none;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    font-size: 24px;
    cursor: pointer;
}

/* Chat window */
#chat-window {
    display: none;
    width: 300px;
    height: 400px;
    background: white;
    border-radius: 12px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.2);
    position: absolute;
    bottom: 80px;
    right: 0;
    overflow: hidden;
}

#chat-header {
    background: linear-gradient(90deg,#6a6fd1,#7b4fb5);
    color: white;
    padding: 10px;
    text-align: center;
    font-weight: bold;
}

#chat-messages {
    height: 270px;
    overflow-y: auto;
    padding: 10px;
    font-size: 14px;
}

#chat-input {
    display: flex;
    padding: 10px;
    gap: 5px;
}

#chat-input input {
    flex: 1;
    padding: 6px;
}

/* Speech bubble */
#chat-bubble {
    position: absolute;
    bottom: 90px;
    right: 10px;
    background: white;
    padding: 10px 16px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    font-size: 14px;

    width: 220px;        /* makes it wider */
    max-width: 260px;
    white-space: normal; /* allows normal wrapping */
    line-height: 1.4;

    animation: fadeOut 6s forwards;
}


@keyframes fadeOut {
    0% {opacity:1;}
    80% {opacity:1;}
    100% {opacity:0;}
}

</style>
</head>

<body>

<!-- Navbar -->
<div class="navbar">
    <h2>üèó BUILDWISE</h2>
    <ul>
        <li><a href="#home">Home</a></li>
        <li><a href="#calculator">Calculator</a></li>
        <li><a href="#features">Features</a></li>
        <li><a href="#contact">Contact</a></li>
    </ul>
</div>

<!-- Hero -->
<section class="hero" id="home">
    <h1>AI-Powered Construction Planning</h1>
    <p>
        Plan your construction projects with precision using advanced AI algorithms.
        Get accurate worker requirements, realistic timelines, and cost analysis in seconds.
    </p>
<button onclick="location.href='#calculator'">
    Start Planning Now
</button>


</section>

<!-- Features -->
<section class="section" id="features">
    <h2>Why Choose BuildAI Pro?</h2>
    <p>Comprehensive features designed for modern construction management</p>

    <div class="cards">
        <div class="card">
            <h3>Smart Calculations</h3>
            <p>AI-driven worker, timeline, and cost estimation.</p>
        </div>
        <div class="card">
            <h3>Professional Blueprints</h3>
            <p>Auto-generated layouts and floor plans.</p>
        </div>
        <div class="card">
            <h3>Detailed Schedules</h3>
            <p>Week-by-week construction planning.</p>
        </div>
    </div>
</section>

<!-- Steps -->
<section class="section">
    <h2>How BuildAI Pro Works</h2>
    <div class="steps">
        <div class="step">
            <div class="circle">1</div>
            <h4>Enter Details</h4>
            <p>Provide area, floors, and budget.</p>
        </div>
        <div class="step">
            <div class="circle">2</div>
            <h4>AI Analysis</h4>
            <p>AI evaluates complexity and cost.</p>
        </div>
        <div class="step">
            <div class="circle">3</div>
            <h4>Get Results</h4>
            <p>Receive blueprints and schedules.</p>
        </div>
        <div class="step">
            <div class="circle">4</div>
            <h4>Execute</h4>
            <p>Use plans for construction.</p>
        </div>
    </div>
</section>

<!-- Calculator -->
<section class="calculator" id="calculator">
    <div class="calc-container">

        <div class="calc-box">
            <h3>Project Details</h3>

            <input id="area" placeholder="Built-up Area (sq yards)">
            <input id="floors" placeholder="Floors (e.g., G+2)">
            <input id="wage" placeholder="Daily wage per worker">
            <input id="cost" placeholder="Cost per sq yard">

            <button class="calc-btn" onclick="calculate()">Calculate Project</button>

        </div>

        <div class="calc-box">
            <h3>Results</h3>
            <div id="results" class="result-box">
                Fill in details to see results.
            </div>
        </div>

    </div>
</section>

<!-- Technology -->
<section class="tech" id="contact">
    <h2 style="text-align:center;margin-bottom:40px;">
        Powered by Advanced Technology
    </h2>

    <div class="tech-cards">
        <div class="tech-card">IBM Granite 3.3</div>
        <div class="tech-card">Flask Backend</div>
        <div class="tech-card">AI Algorithms</div>
        <div class="tech-card">Responsive Design</div>
    </div>
</section>

<!-- AI Chatbot -->
<div id="chatbot">
    <div id="chat-bubble">Hello! Glad to see you. I'm here to help.</div>

    <div id="chat-window">
        <div id="chat-header">BuildWise AI Assistant</div>
        <div id="chat-messages"></div>

        <div id="chat-input">
            <input id="chat-text" placeholder="Ask something..." />
            <button onclick="sendMessage()">Send</button>
            <button onclick="startListening()">üé§</button>
        </div>
    </div>

    <button id="chat-toggle" onclick="toggleChat()">üí¨</button>
</div>
<script>
/* ---------------- CHATBOT ---------------- */

function toggleChat() {
    let win = document.getElementById("chat-window");
    win.style.display = win.style.display === "block" ? "none" : "block";
}

function addMessage(sender, text) {
    let msgBox = document.getElementById("chat-messages");
    let msg = document.createElement("div");
    msg.innerHTML = "<b>" + sender + ":</b> " + text;
    msgBox.appendChild(msg);
    msgBox.scrollTop = msgBox.scrollHeight;
}

function speak(text) {
    let speech = new SpeechSynthesisUtterance(text);
    speech.lang = "en-US";
    window.speechSynthesis.speak(speech);
}

async function sendMessage() {
    let input = document.getElementById("chat-text");
    let message = input.value;
    if (!message) return;

    addMessage("You", message);
    input.value = "";

    try {
        let response = await fetch("/chat", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({message: message})
        });

        let data = await response.json();
        addMessage("AI", data.reply);
        speak(data.reply);

    } catch (e) {
        addMessage("AI", "Connection error.");
    }
}

function startListening() {
    let SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (!SpeechRecognition) {
        alert("Speech not supported.");
        return;
    }

    let recognition = new SpeechRecognition();
    recognition.lang = "en-US";

    recognition.onresult = function(event) {
        document.getElementById("chat-text").value =
            event.results[0][0].transcript;
        sendMessage();
    };

    recognition.start();
}

/* Auto greeting */
window.onload = function() {
    let greeting = "Hello! Glad to see you. I'm here to help.";
    speak(greeting);
};


/* ---------------- CALCULATOR ---------------- */

async function calculate() {
    let area = document.getElementById("area").value;
    let floors = document.getElementById("floors").value;
    let wage = document.getElementById("wage").value;
    let cost = document.getElementById("cost").value;

    document.getElementById("results").innerHTML = "Calculating...";

    try {
        let response = await fetch("/analyze", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({
                area: area,
                floors: floors,
                wage: wage,
                cost: cost
            })
        });

        let data = await response.json();

        // Safe weekly schedule handling
        let weeklyHTML = "";
        if (data.weekly_schedule && data.weekly_schedule.length > 0) {
            weeklyHTML = data.weekly_schedule.map(w =>
                `Week ${w.week}: ${w.task}
                 <br><small>Materials: ${w.materials} | Workers: ${w.workers}</small><br><br>`
            ).join("");
        } else {
            weeklyHTML = "Weekly schedule not available.";
        }

        document.getElementById("results").innerHTML = `

<style>
details {
    background: #f5f6fa;
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 8px;
    cursor: pointer;
}
summary {
    font-weight: bold;
    font-size: 16px;
}
</style>

<!-- Workers + Cost -->
<details open>
<summary>Workforce & Cost Overview</summary>
<b>Workers:</b> ${data.workers}<br>
<small>${data.explanations.workers}</small><br><br>

<b>Worker Breakdown:</b><br>
- Masons: ${data.worker_breakdown.masons.count}
  <small>(${data.worker_breakdown.masons.duty})</small><br>
- Helpers: ${data.worker_breakdown.helpers.count}
  <small>(${data.worker_breakdown.helpers.duty})</small><br>
- Steel Workers: ${data.worker_breakdown.steel_workers.count}
  <small>(${data.worker_breakdown.steel_workers.duty})</small><br>
- Carpenters: ${data.worker_breakdown.carpenters.count}
  <small>(${data.worker_breakdown.carpenters.duty})</small><br>
- Electricians: ${data.worker_breakdown.electricians.count}
  <small>(${data.worker_breakdown.electricians.duty})</small><br>
- Plumbers: ${data.worker_breakdown.plumbers.count}
  <small>(${data.worker_breakdown.plumbers.duty})</small><br>
- Supervisors: ${data.worker_breakdown.supervisors.count}
  <small>(${data.worker_breakdown.supervisors.duty})</small><br><br>

<b>Duration:</b> ${data.duration_days} days<br>
<small>${data.explanations.duration}</small><br><br>

<b>Labor Cost:</b> ‚Çπ${data.labor_cost}<br>
<small>${data.explanations.labor_cost}</small><br><br>

<b>Material Cost:</b> ‚Çπ${data.material_cost}<br>
<small>${data.explanations.material_cost}</small><br><br>

<h3>Total Cost: ‚Çπ${data.total_cost}</h3>
<small>${data.explanations.total_cost}</small>
</details>

<!-- Floor Plan -->
<details>
<summary>Generated Floor Plan</summary>
<img src="${data.floorplan}" 
     style="width:100%;max-width:400px;border-radius:8px;margin-top:10px;">
</details>

<!-- Weekly Schedule -->
<details>
<summary>Weekly Construction Schedule</summary>
${weeklyHTML}
</details>

<!-- Alternative Plans -->
<details>
<summary>Alternative Construction Plans</summary>
${data.alternative_plans.map(p =>
    `<b>${p.name}</b><br>
     Workers: ${p.workers}<br>
     Duration: ${p.duration} days<br>
     Total Cost: ‚Çπ${p.total_cost}<br><br>`
).join("")}
</details>

<!-- Sustainability -->
<details>
<summary>Sustainability Options</summary>
${data.sustainability_options.map(s =>
    `<b>${s.material}</b><br>
     Impact: ${s.impact}<br>
     Cost Change: ${s.cost_change}<br><br>`
).join("")}
</details>
<!-- Material Delivery Planner -->
<details>
<summary>Material Delivery Planner</summary>
${data.material_delivery.map(m =>
    `<b>Week ${m.week}:</b> ${m.materials}<br>
     <small>${m.note}</small><br><br>`
).join("")}
</details>
<!-- Project Timeline -->
<details>
<summary>Project Timeline</summary>

<div style="margin-top:10px;">
${data.timeline.map(t => `
    <div style="margin-bottom:10px;">
        <b>${t.phase}</b> ‚Äî ${t.duration} days
        <div style="
            height:10px;
            background:${t.color};
            width:${t.duration * 2}px;
            border-radius:5px;
            margin-top:4px;">
        </div>
    </div>
`).join("")}
</div>

</details>


`;

    } catch (err) {
        console.error(err);
        document.getElementById("results").innerHTML =
            "Error connecting to backend.";
    }
}

</script>



</body>
</html>

